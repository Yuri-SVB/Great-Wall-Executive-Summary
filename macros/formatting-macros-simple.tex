% Formatting Macros - Simplified and Working Version
% Reusable formatting commands for consistent document styling

% =============================================================================
% TABLE FORMATTING ENVIRONMENTS
% =============================================================================

% Financial summary table
\newenvironment{financialtable}[1]{%
  \begin{table}[htbp]
    \centering
    \caption{#1}
    \begin{tabular}{lccc}
      \toprule
      \rowcolor{LightGray}
      \textbf{Metric} & \textbf{Conservative} & \textbf{Base Case} & \textbf{Aggressive} \\
      \midrule
}{%
      \bottomrule
    \end{tabular}
  \end{table}
}

% Key metrics dashboard
\newenvironment{metricsdashboard}{%
  \begin{table}[htbp]
    \centering
    \begin{tabular}{@{}ll@{}}
      \toprule
      \rowcolor{LightGray}
      \textbf{Key Performance Indicator} & \textbf{Value} \\
      \midrule
}{%
      \bottomrule
    \end{tabular}
  \end{table}
}

% Revenue projection table environment
\newenvironment{revenuetable}{%
  \begin{longtable}{lrrrrr}
    \caption{Five-Year Revenue Projections (\CurrencySymbol 000s)} \\
    \toprule
    \rowcolor{LightGray}
    \textbf{Year} & \textbf{2025} & \textbf{2026} & \textbf{2027} & \textbf{2028} & \textbf{2029} \\
    \midrule
    \endfirsthead
    \multicolumn{6}{c}{\textit{(Continued from previous page)}} \\
    \toprule
    \rowcolor{LightGray}
    \textbf{Year} & \textbf{2025} & \textbf{2026} & \textbf{2027} & \textbf{2028} & \textbf{2029} \\
    \midrule
    \endhead
    \midrule
    \multicolumn{6}{r}{\textit{(Continued on next page)}} \\
    \endfoot
    \bottomrule
    \endlastfoot
}{%
  \end{longtable}
}

% =============================================================================
% VISUAL EMPHASIS MACROS
% =============================================================================

% Highlighted number box
\newcommand{\highlightednumber}[2]{%
  \begin{center}
    \fcolorbox{PrimaryColor}{LightGray}{%
      \begin{minipage}{3cm}
        \centering
        \Large\textbf{\color{PrimaryColor}#1}\\
        \small\color{TextColor}#2
      \end{minipage}
    }
  \end{center}
}

% Metric card for dashboard display
\newcommand{\metriccard}[3]{%
  \begin{minipage}[t]{0.3\textwidth}
    \centering
    \fcolorbox{SecondaryColor}{white}{%
      \begin{minipage}{0.9\textwidth}
        \centering
        \vspace{0.5em}
        \textbf{\Large\color{PrimaryColor}#1}\\[0.3em]
        \textsc{\color{TextColor}#2}\\[0.2em]
        \small\textit{\color{SecondaryColor}#3}
        \vspace{0.5em}
      \end{minipage}
    }
  \end{minipage}
}

% =============================================================================
% LAYOUT AND SPACING HELPERS
% =============================================================================

% Section break with visual separator
\newcommand{\sectionbreak}{%
  \vspace{1em}
  \begin{center}
    \color{SecondaryColor}\rule{0.5\textwidth}{0.5pt}
  \end{center}
  \vspace{1em}
}

% Page break with continuation notice
\newcommand{\continuationbreak}[1]{%
  \vfill
  \begin{center}
    \textit{\color{SecondaryColor}Continued: #1}
  \end{center}
  \newpage
}

% Simple executive box (temporary replacement)
\newcommand{\executivebox}[1]{%
  \begin{center}
    \colorbox{LightGray}{%
      \parbox{0.95\textwidth}{%
        \vspace{0.5em}
        #1
        \vspace{0.5em}
      }
    }
  \end{center}
}

% Simple market size visualization placeholder
\newcommand{\marketsizechart}{%
  \begin{center}
    \textit{[Market Size Chart - TAM: \$250B, SAM: \$75B, SOM: \$7.5B]}
  \end{center}
}

% Simple revenue chart placeholder  
\newcommand{\revenuechart}{%
  \begin{center}
    \textit{[Revenue Chart - Growth from \$2.5M (2025) to \$117.6M (2029)]}
  \end{center}
}